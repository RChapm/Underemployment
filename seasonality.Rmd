---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

<!-- This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code.  -->

<!-- Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*.  -->

<!-- ```{r} -->
<!-- plot(cars) -->
<!-- ``` -->

<!-- Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*. -->

<!-- When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file). -->

<!-- The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed. -->

Import the data
```{r}
rm(list=ls())
z<-read.csv('rawdata.csv', skip = 0, header = TRUE)

z=z[-(1:167),]
print(z)
names(z)[[2]]="Underemployment"
#print(z)
UnEmp=ts(z$Underemployment,start=c(2007,12),freq=12)
plot(UnEmp)
diffUnEmp=lag(UnEmp)-UnEmp
UnEmp
diffUnEmp
#plot(UnEmp-dynlm::L(UnEmp))
plot(log(UnEmp))
curve(dpois(x,lambda=2),from=0,to=100)
```

Do the seasonality model
```{r}
suppressPackageStartupMessages(library(forecast))
seas=tslm(UnEmp~season)
seas
```
```{r}
seas_factors=seas$coef
seas_factors[1]=0
names(seas_factors)[1]='season1'
plot(seas_factors,type='l',ylab='Seasonal Factors', xlab="Month",lwd=2, main="Plot of Seasonal Factors")
```

```{r}
hist(seas$res,main="Histogram of Residuals",col="skyblue3")
```

